---

- block:
    - name: check package state file
      stat:
        path: "{{ packages_state_file }}"
      register: packages_state_file_obj

    - name: load package state file
      include_vars:
        file: "{{ packages_state_file }}"
        name: package_state
      when: packages_state_file_obj.stat.exists

    - name: set empty package_state object
      set_fact:
        package_state: []
      when: not packages_state_file_obj.stat.exists|bool
  when: package_state is not defined

- name: set default value for package_condition
  set_fact:
    package_condition: false

- name: set package_condition variable
  set_fact:
    package_condition: "{{ package_state[state_package_name + '-' + state_package_version] }}"
  when: package_state[state_package_name + '-' + state_package_version] is defined
